<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 1. Admin Guide</title><meta name="generator" content="DocBook XSL Stylesheets V1.77.1"/></head><body><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="d6e1"/>Chapter 1. Admin Guide</h2></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="section"><a href="#d6e3">Overview</a></span></dt><dt><span class="section"><a href="#d6e6">Dependencies</a></span></dt><dd><dl><dt><span class="section"><a href="#d6e8">Kamailio Modules</a></span></dt><dt><span class="section"><a href="#d6e15">External Libraries or Applications</a></span></dt></dl></dd><dt><span class="section"><a href="#d6e67">Java runtime</a></span></dt><dd><dl><dt><span class="section"><a href="#d6e69"/></span></dt></dl></dd><dt><span class="section"><a href="#d6e72">Parameters</a></span></dt><dd><dl><dt><span class="section"><a href="#d6e74"><code class="varname">class_name</code> (string)</a></span></dt><dt><span class="section"><a href="#d6e87"><code class="varname">child_init_method</code> (string)</a></span></dt><dt><span class="section"><a href="#d6e98"><code class="varname">java_options</code> (string)</a></span></dt><dt><span class="section"><a href="#d6e123"><code class="varname">force_kam_cmd_exec</code> (int)</a></span></dt></dl></dd><dt><span class="section"><a href="#d6e135">Functions</a></span></dt><dd><dl><dt><span class="section"><a href="#d6e137">
    			Common requirements
    		</a></span></dt><dt><span class="section"><a href="#d6e146">java_method_exec(method, method_signature, [param1[, param2[, ...]]])</a></span></dt><dt><span class="section"><a href="#d6e181">java_staticmethod_exec(method, method_signature, [param1[, param2[, ...]]])</a></span></dt><dt><span class="section"><a href="#d6e216">java_s_method_exec(method, method_signature, [param1[, param2[, ...]]])</a></span></dt><dt><span class="section"><a href="#d6e254">java_s_staticmethod_exec(method, method_signature, [param1[, param2[, ...]]])</a></span></dt></dl></dd><dt><span class="section"><a href="#d6e292">Java Module API</a></span></dt><dd><dl><dt><span class="section"><a href="#d6e295">Minimal program skeleton</a></span></dt></dl></dd></dl></div>
    
    
    
    
    <div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d6e3"/>Overview</h2></div></div></div>
		
		<p>
			This module allows executing Java compiled classes from config file, exporting
			functions to access the SIP message from Java using Java Native Interface (JNI).
		</p>
    </div>
	
	
	
    <div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d6e6"/>Dependencies</h2></div></div></div>
		
    	
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e8"/>Kamailio Modules</h3></div></div></div>
		    
		    <p>
			The following modules must be loaded before this module:
		    	</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
				<p>
				    <span class="emphasis"><em>none</em></span>.
				</p>
			    </li></ul></div><p>
		    </p>
		</div>
    	
    	
    	
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e15"/>External Libraries or Applications</h3></div></div></div>
		    
		    <p>
			
		    	</p><div class="itemizedlist"><p><span class="emphasis"><em>The following packages are runtime libraries, required to launch</em></span></p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem" style="list-style-type: disc"><p><span class="emphasis"><em>java-common</em></span> Base of all Java packages.</p></li><li class="listitem" style="list-style-type: disc"><p><span class="emphasis"><em>default-jre</em></span> Standard Java or Java compatible Runtime.</p></li><li class="listitem" style="list-style-type: disc"><p><span class="emphasis"><em>gcj-jre</em></span> Java runtime environment using GIJ/classpath.</p></li><li class="listitem" style="list-style-type: disc"><p><span class="emphasis"><em>libgcj12 (&gt;=12)</em></span> Java runtime library for use with gcj.</p></li></ul></div><p>
		    	</p><div class="itemizedlist"><p><span class="emphasis"><em>The following packages are optional, required for development</em></span></p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem" style="list-style-type: square"><p><span class="emphasis"><em>ant</em></span> Java based build tool like make.</p></li><li class="listitem" style="list-style-type: square"><p><span class="emphasis"><em>ant-contrib</em></span> Collection of tasks, types and other tools for Apache Ant.</p></li><li class="listitem" style="list-style-type: square"><p><span class="emphasis"><em>ant-gcj</em></span> Java based build tool like make (GCJ).</p></li><li class="listitem" style="list-style-type: square"><p><span class="emphasis"><em>default-jdk</em></span> Standard Java or Java compatible Development Kit</p></li><li class="listitem" style="list-style-type: square"><p><span class="emphasis"><em>gcj-jdk</em></span> gcj and classpath development tools for Java(TM)</p></li><li class="listitem" style="list-style-type: square"><p><span class="emphasis"><em>libgcj13-dev (&gt;=12)</em></span> Java development headers for use with gcj</p></li><li class="listitem" style="list-style-type: square"><p><span class="emphasis"><em>jdk</em></span> JDK Development Kit (either oracle jdk or openjdk)</p></li></ul></div><p>
		    </p>
			<p>
				The following libraries or applications must be compiled before
				running Kamailio with this module loaded:
				</p><div class="itemizedlist"><p><span class="emphasis"><em>The following packages are runtime libraries, required to launch</em></span></p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem" style="list-style-type: circle"><p><span class="emphasis"><em>&lt;class_name&gt;</em></span>.class</p></li><li class="listitem" style="list-style-type: circle"><p><span class="emphasis"><em>kamailio</em></span>.jar</p></li></ul></div><p>
			</p>
		</div>
    	
    </div>
	
	
	
	<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d6e67"/>Java runtime</h2></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e69"/></h3></div></div></div>
			
			<p>Java runtime library (JRE or JDK) is required to use this module.</p>
		</div>
	</div>
	
	
	
	<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d6e72"/>Parameters</h2></div></div></div>
		

		
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e74"/><code class="varname">class_name</code> (string)</h3></div></div></div>
			
		    <p>
		    	The class name should have the same compiled file name.
		    	If the value is <span class="emphasis"><em>"Kamailio"</em></span>, then the compiled file should be named as <span class="emphasis"><em>"Kamailio.class"</em></span>.
		    </p>
		    <p>
				<span class="emphasis"><em>
					Default value is <span class="quote">“<span class="quote">Kamailio</span>”</span>.
				</em></span>
		    </p>
		    <div class="example"><a id="d6e83"/><p class="title"><strong>Example 1.1. Set <code class="varname">class_name</code> parameter</strong></p><div class="example-contents">
		    	
				<pre class="programlisting">
...
modparam("app_java", "class_name", "Kamailio")
...
</pre>
		    </div></div><br class="example-break"/>
		</div>

		
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e87"/><code class="varname">child_init_method</code> (string)</h3></div></div></div>
			
			<p>
				TBD.
			</p>
			<p>
				<span class="emphasis"><em>
					Default value is <span class="quote">“<span class="quote">child_init</span>”</span>.
				</em></span>
			</p>
			<div class="example"><a id="d6e94"/><p class="title"><strong>Example 1.2. Set <code class="varname">child_init_method</code> parameter</strong></p><div class="example-contents">
				
				<pre class="programlisting">
...
modparam("app_java", "child_init_method", "my_mod_init")
...
</pre>
			</div></div><br class="example-break"/>
		</div>

		
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e98"/><code class="varname">java_options</code> (string)</h3></div></div></div>
			
			<p>
				Java options for Java Virtual Machine.
				For more info read <a class="ulink" href="http://docs.oracle.com/javase/6/docs/technotes/tools/windows/java.html" target="_top"><em class="citetitle">java docs</em></a>
			</p>
			<p>
				<span class="emphasis"><em>
					Default value is <span class="quote">“<span class="quote">-Djava.compiler=NONE</span>”</span>.
				</em></span>
			</p>
			<div class="example"><a id="d6e107"/><p class="title"><strong>Example 1.3. Set <code class="varname">java_options</code> parameter</strong></p><div class="example-contents">
				
				<pre class="programlisting">
...
modparam("app_java", "java_options", "-Djava.compiler=NONE")
...
</pre>
			</div></div><br class="example-break"/>
			<div class="example"><a id="d6e111"/><p class="title"><strong>Example 1.4. Set <code class="varname">java_options</code> parameter (live configuration)</strong></p><div class="example-contents">
				
				<pre class="programlisting">
...
# Assumes "application java folder" is located at /opt/kamailio/java
modparam("app_java", "java_options", "-Djava.compiler=NONE -Djava.class.path=/path/to/kamailio/modules:/opt/kamailio/java:/opt/kamailio/java/kamailio.jar")
...
</pre>
			</div></div><br class="example-break"/>
			<div class="example"><a id="d6e115"/><p class="title"><strong>Example 1.5. Set <code class="varname">java_options</code> parameter (verbose configuration)</strong></p><div class="example-contents">
				
				<pre class="programlisting">
...
# Assumes "application java folder" is located at /opt/kamailio/java
modparam("app_java", "java_options", "-verbose:gc,class,jni -Djava.compiler=NONE -Djava.class.path=/path/to/kamailio/modules:/opt/kamailio/java:/opt/kamailio/java/kamailio.jar")
...
</pre>
			</div></div><br class="example-break"/>
			<div class="example"><a id="d6e119"/><p class="title"><strong>Example 1.6. Set <code class="varname">java_options</code> parameter (debug configuration)</strong></p><div class="example-contents">
				
				<pre class="programlisting">
...
# Assumes "application java folder" is located at /opt/kamailio/java
modparam("app_java", "java_options", "-Xdebug -verbose:gc,class,jni -Djava.compiler=NONE -Djava.class.path=/path/to/kamailio/modules:/opt/kamailio/java:/opt/kamailio/java/kamailio.jar")
...
</pre>
			</div></div><br class="example-break"/>
		</div>

		
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e123"/><code class="varname">force_kam_cmd_exec</code> (int)</h3></div></div></div>
			
			<p>
				This parameter forces execution a kamailio comnmand with java native method <span class="quote">“<span class="quote">KamExec</span>”</span>.
				# Note: this is an untested yet feature, may cause (but may not) a memory leaks if used from embedded languages.
			</p>
			<p>
				<span class="emphasis"><em>
					Default value is <span class="quote">“<span class="quote">0 (off)</span>”</span>.
				</em></span>
			</p>
			<div class="example"><a id="d6e131"/><p class="title"><strong>Example 1.7. Set <code class="varname">force_kam_cmd_exec</code> parameter</strong></p><div class="example-contents">
				
				<pre class="programlisting">
...
modparam("app_java", "force_kam_cmd_exec", 1)
...
</pre>
			</div></div><br class="example-break"/>
		</div>
	</div>
	
	
	
    <div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d6e135"/>Functions</h2></div></div></div>
		
    	
    	
    	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e137"/>
    			Common requirements
    		</h3></div></div></div>
    		
    		<p>Each function has a required parameter <span class="quote">“<span class="quote">method_signature</span>”</span>. For more info
				see <a class="ulink" href="http://www.rgagnon.com/javadetails/java-0286.html" target="_top"><em class="citetitle">Determine the signature of a method</em></a>.
				Signature represents the variable type. The mapping between the Java type and C type
				is
				</p><pre class="programlisting">
		Type     Chararacter 
		boolean      Z 
		byte         B 
		char         C 
		double       D 
		float        F 
		int          I 
		long         J 
		object       L 
		short        S 
		void         V 
		Note that to specify an object, the "L" is followed by the object's class name and ends with a semi-colon, ';' .
    			</pre><p>
			</p>
    		<p> app_java supports the following signatures:
				</p><pre class="programlisting">
		Primitives: Z,B,C,D,F,I,J,L,S,V
		Objects: 
			Ljava/lang/Boolean;
			Ljava/lang/Byte;
			Ljava/lang/Character;
			Ljava/lang/Double;
			Ljava/lang/Float;
			Ljava/lang/Integer;
			Ljava/lang/Long;
			Ljava/lang/Short;
			Ljava/lang/String;
			NULL parameter: V

	Each parameter passed to function will be cast according to given signature.
	
	Parameters are optional, ommitting a parameter meant the passed value is NULL.
	Parameters count should be exactly the same as signature count.
	Note 1: Arrays representation (symbol '[') is not supported yet.
	Note 2: You shall use a correct signature, e.g. the following examples of combinations are invalid:    
    	java_method_exec("ExampleMethod", "ZI", "False");
        java_method_exec("ExampleMethod", "LI", "something", "5");
</pre><p>
			</p>

 
    	</div>
    	
  
    	
    	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e146"/>java_method_exec(method, method_signature, [param1[, param2[, ...]]])</h3></div></div></div>
    		
    		<p>Executes a java class method <span class="emphasis"><em>method</em></span>. Parameter <span class="emphasis"><em>method_signature</em></span> is required.</p>
    		<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
			    	<div class="example"><a id="d6e153"/><p class="title"><strong>Example 1.8. Signature: "V"</strong></p><div class="example-contents">
						
			    		<p>Kamailio prototype</p>
			    		<pre class="programlisting">java_method_exec("ExampleMethod", "V");</pre>
			    		<p>Java prototype</p>
			    		<pre class="programlisting">public int ExampleMethod();</pre>
			    		<p>Example of usage:</p>
			    		<pre class="programlisting">
# Kamailio
java_method_exec("ExampleMethod", "V");

# Java
public int ExampleMethod()
{
		... do something;
		return 1;
}
</pre>
			    	</div></div><br class="example-break"/>
	    		</li><li class="listitem">
	    			<div class="example"><a id="d6e162"/><p class="title"><strong>Example 1.9. Signature: "Ljava/lang/String;I"</strong></p><div class="example-contents">
	    				
	    				<p>Kamailio prototype</p>
		    			<pre class="programlisting">java_method_exec("ExampleMethod", "Ljava/lang/String;I", "Hello world", "5");</pre>
	    				<p>Java prototype</p>
	    				<pre class="programlisting">public int ExampleMethod(String param1, int param2);</pre>
	    				<p>In the above scenario parameter 2 ("5") will be cast to integer representation.</p>
	    				<p>Example of usage:</p>
	    				<pre class="programlisting">
# Kamailio
java_method_exec("ExampleMethod", "Ljava/lang/String;I", "$mb", "$ml");

# Java
public int ExampleMethod(String SipMessageBuffer, int SipMessageLenght)
{
		... do something with buffer;
		return 1;
}
</pre>
	    			</div></div><br class="example-break"/>
	    		</li><li class="listitem">
    				<div class="example"><a id="d6e172"/><p class="title"><strong>Example 1.10. Signature: "ZB"</strong></p><div class="example-contents">
    					
    					<p>Kamailio prototype</p>
    					<pre class="programlisting">java_method_exec("ExampleMethod", "ZB", "true", "0x05");</pre>
    					<p>Java prototype</p>
    					<pre class="programlisting">public int ExampleMethod(boolean param1, byte param2);</pre>
    					<p>In the above scenario parameter 1 ("true") will be cast to boolean representation.</p>
    					<p>Example of usage:</p>
    					<pre class="programlisting">
# Kamailio
java_method_exec("ExampleMethod", "ZB", "true", "0x05");

# Java
public int ExampleMethod(boolean flagSet, byte bFlag);
{
		if (flagSet)
		{
			... do something with flags;
		}
		return 1;
}
</pre>
    				</div></div><br class="example-break"/>
    			</li></ul></div>
    	</div>
    	

    	
    	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e181"/>java_staticmethod_exec(method, method_signature, [param1[, param2[, ...]]])</h3></div></div></div>
    		
    		<p>Executes a java static method <span class="emphasis"><em>method</em></span>. Parameter <span class="emphasis"><em>method_signature</em></span> is required.</p>
    		<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
    				<div class="example"><a id="d6e188"/><p class="title"><strong>Example 1.11. Signature: "V"</strong></p><div class="example-contents">
    					
    					<p>Kamailio prototype</p>
    					<pre class="programlisting">java_staticmethod_exec("ExampleMethod", "V");</pre>
    					<p>Java prototype</p>
    					<pre class="programlisting">public static int ExampleMethod();</pre>
    					<p>Example of usage:</p>
    					<pre class="programlisting">
# Kamailio
java_staticmethod_exec("ExampleMethod", "V");

# Java
public static int ExampleMethod()
{
		... do something;
		return 1;
}
</pre>
    				</div></div><br class="example-break"/>
    			</li><li class="listitem">
    				<div class="example"><a id="d6e197"/><p class="title"><strong>Example 1.12. Signature: "Ljava/lang/String;I"</strong></p><div class="example-contents">
    					
    					<p>Kamailio prototype</p>
    					<pre class="programlisting">java_staticmethod_exec("ExampleMethod", "Ljava/lang/String;I", "Hello world", "5");</pre>
    					<p>Java prototype</p>
    					<pre class="programlisting">public static int ExampleMethod(String param1, int param2);</pre>
    					<p>In the above scenario parameter 2 ("5") will be cast to integer representation.</p>
    					<p>Example of usage:</p>
    					<pre class="programlisting">
# Kamailio
java_staticmethod_exec("ExampleMethod", "Ljava/lang/String;I", "$mb", "$ml");

# Java
public static int ExampleMethod(String SipMessageBuffer, int SipMessageLenght)
{
		... do something with buffer;
		return 1;
}
</pre>
    				</div></div><br class="example-break"/>
    			</li><li class="listitem">
    				<div class="example"><a id="d6e207"/><p class="title"><strong>Example 1.13. Signature: "ZB"</strong></p><div class="example-contents">
    					
    					<p>Kamailio prototype</p>
    					<pre class="programlisting">java_staticmethod_exec("ExampleMethod", "ZB", "true", "0x05");</pre>
    					<p>Java prototype</p>
    					<pre class="programlisting">public static int ExampleMethod(boolean param1, byte param2);</pre>
    					<p>In the above scenario parameter 1 ("true") will be cast to boolean representation.</p>
    					<p>Example of usage:</p>
    					<pre class="programlisting">
# Kamailio
java_staticmethod_exec("ExampleMethod", "ZB", "true", "0x05");

# Java
public static int ExampleMethod(boolean flagSet, byte bFlag);
{
		if (flagSet)
		{
			... do something with flags;
		}
		return 1;
}
</pre>
    				</div></div><br class="example-break"/>
    			</li></ul></div>
    	</div>
    	
    	
    	
    	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e216"/>java_s_method_exec(method, method_signature, [param1[, param2[, ...]]])</h3></div></div></div>
    		
    		<p>Executes a java class synchronized method <span class="emphasis"><em>method</em></span>. Parameter <span class="emphasis"><em>method_signature</em></span> is required.</p>
    		<p>For more info see <a class="ulink" href="http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html" target="_top"><em class="citetitle">Synchronized Methods</em></a></p>
    		<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
    				<div class="example"><a id="d6e226"/><p class="title"><strong>Example 1.14. Signature: "V"</strong></p><div class="example-contents">
    					
    					<p>Kamailio prototype</p>
    					<pre class="programlisting">java_s_method_exec("ExampleMethod", "V");</pre>
    					<p>Java prototype</p>
    					<pre class="programlisting">public synchronized int ExampleMethod();</pre>
    					<p>Example of usage:</p>
    					<pre class="programlisting">
# Kamailio
java_s_method_exec("ExampleMethod", "V");

# Java
public synchronized int ExampleMethod()
{
		... do something;
		return 1;
}
</pre>
    				</div></div><br class="example-break"/>
    			</li><li class="listitem">
    				<div class="example"><a id="d6e235"/><p class="title"><strong>Example 1.15. Signature: "Ljava/lang/String;I"</strong></p><div class="example-contents">
    					
    					<p>Kamailio prototype</p>
    					<pre class="programlisting">java_s_method_exec("ExampleMethod", "Ljava/lang/String;I", "Hello world", "5");</pre>
    					<p>Java prototype</p>
    					<pre class="programlisting">public synchronized int ExampleMethod(String param1, int param2);</pre>
    					<p>In the above scenario parameter 2 ("5") will be cast to integer representation.</p>
    					<p>Example of usage:</p>
    					<pre class="programlisting">
# Kamailio
java_s_method_exec("ExampleMethod", "Ljava/lang/String;I", "$mb", "$ml");

# Java
public synchronized int ExampleMethod(String SipMessageBuffer, int SipMessageLenght)
{
		... do something with buffer;
		return 1;
}
</pre>
    				</div></div><br class="example-break"/>
    			</li><li class="listitem">
    				<div class="example"><a id="d6e245"/><p class="title"><strong>Example 1.16. Signature: "ZB"</strong></p><div class="example-contents">
    					
    					<p>Kamailio prototype</p>
    					<pre class="programlisting">java_s_method_exec("ExampleMethod", "ZB", "true", "0x05");</pre>
    					<p>Java prototype</p>
    					<pre class="programlisting">public synchronized int ExampleMethod(boolean param1, byte param2);</pre>
    					<p>In the above scenario parameter 1 ("true") will be cast to boolean representation.</p>
    					<p>Example of usage:</p>
    					<pre class="programlisting">
# Kamailio
java_s_method_exec("ExampleMethod", "ZB", "true", "0x05");

# Java
public synchronized int ExampleMethod(boolean flagSet, byte bFlag);
{
		if (flagSet)
		{
			... do something with flags;
		}
		return 1;
}
</pre>
    				</div></div><br class="example-break"/>
    			</li></ul></div>
    	</div>
    	
    	
    	
    	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e254"/>java_s_staticmethod_exec(method, method_signature, [param1[, param2[, ...]]])</h3></div></div></div>
    		
    		<p>Executes a java synchronized static method <span class="emphasis"><em>method</em></span>. Parameter <span class="emphasis"><em>method_signature</em></span> is required.</p>
    		<p>For more info see <a class="ulink" href="http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html" target="_top"><em class="citetitle">Synchronized Methods</em></a></p>
    		<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
    				<div class="example"><a id="d6e264"/><p class="title"><strong>Example 1.17. Signature: "V"</strong></p><div class="example-contents">
    					
    					<p>Kamailio prototype</p>
    					<pre class="programlisting">java_s_staticmethod_exec("ExampleMethod", "V");</pre>
    					<p>Java prototype</p>
    					<pre class="programlisting">public static synchronized int ExampleMethod();</pre>
    					<p>Example of usage:</p>
    					<pre class="programlisting">
# Kamailio
java_s_staticmethod_exec("ExampleMethod", "V");

# Java
public static synchronized int ExampleMethod()
{
		... do something;
		return 1;
}
</pre>
    				</div></div><br class="example-break"/>
    			</li><li class="listitem">
    				<div class="example"><a id="d6e273"/><p class="title"><strong>Example 1.18. Signature: "Ljava/lang/String;I"</strong></p><div class="example-contents">
    					
    					<p>Kamailio prototype</p>
    					<pre class="programlisting">java_s_staticmethod_exec("ExampleMethod", "Ljava/lang/String;I", "Hello world", "5");</pre>
    					<p>Java prototype</p>
    					<pre class="programlisting">public static synchronized int ExampleMethod(String param1, int param2);</pre>
    					<p>In the above scenario parameter 2 ("5") will be cast to integer representation.</p>
    					<p>Example of usage:</p>
    					<pre class="programlisting">
# Kamailio
java_s_staticmethod_exec("ExampleMethod", "Ljava/lang/String;I", "$mb", "$ml");

# Java
public static synchronized int ExampleMethod(String SipMessageBuffer, int SipMessageLenght)
{
		... do something with buffer;
		return 1;
}
</pre>
    				</div></div><br class="example-break"/>
    			</li><li class="listitem">
    				<div class="example"><a id="d6e283"/><p class="title"><strong>Example 1.19. Signature: "ZB"</strong></p><div class="example-contents">
    					
    					<p>Kamailio prototype</p>
    					<pre class="programlisting">java_s_staticmethod_exec("ExampleMethod", "ZB", "true", "0x05");</pre>
    					<p>Java prototype</p>
    					<pre class="programlisting">public static synchronized int ExampleMethod(boolean param1, byte param2);</pre>
    					<p>In the above scenario parameter 1 ("true") will be cast to boolean representation.</p>
    					<p>Example of usage:</p>
    					<pre class="programlisting">
# Kamailio
java_s_staticmethod_exec("ExampleMethod", "ZB", "true", "0x05");

# Java
public static synchronized int ExampleMethod(boolean flagSet, byte bFlag);
{
		if (flagSet)
		{
			... do something with flags;
		}
		return 1;
}
</pre>
    				</div></div><br class="example-break"/>
    			</li></ul></div>
    	</div>
    	

    </div>
	
	
	
    <div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d6e292"/>Java Module API</h2></div></div></div>
		
    	<p/>
    	
    	
    	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="d6e295"/>Minimal program skeleton</h3></div></div></div>
    		
    		<p/>
    		<div class="example"><a id="d6e298"/><p class="title"><strong>Example 1.20. Minimal program skeleton</strong></p><div class="example-contents">
    			
    			<p/>
    			<pre class="programlisting">
import org.siprouter.*;
import org.siprouter.NativeInterface.*;

public class Kamailio extends NativeMethods
{
		/* Here you should specify a full path to app_java.so */
		static
		{
				System.load("/opt/kamailio/lib/kamailio/modules/app_java.so");
		}

		/* Constructor. Do not remove !!! */
		public Kamailio()
		{
		}

		/*
		This method should be executed for each children process, immediately after forking.
		Required. Do not remove !!!
		*/
		public int child_init(int rank)
		{
				return 1;
		}
}
</pre>
    		</div></div><br class="example-break"/>
    	</div>
    	
    	
    </div>
	
	
</div></body></html>